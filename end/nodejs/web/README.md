# OAuth2 Service Account Web管理界面

## 🚀 概述

这是一个现代化的React + Tailwind CSS Web管理界面，用于管理Google Service Account和OAuth2令牌映射。界面提供了直观的用户体验，支持服务账号的创建、编辑、删除和密钥重新生成等功能。

## 📁 文件结构

```
web/
├── public/
│   └── index.html          # 主界面文件（包含完整的React应用）
└── README.md              # 使用说明
```

## 🌟 主要功能

### 1. 用户管理
- **用户选择器**: 从配置文件中加载用户列表
- **用户状态**: 显示用户的服务类型和状态
- **快速切换**: 支持在不同用户间快速切换

### 2. Service Account 管理
- **✅ 查看服务账号**: 卡片式展示所有服务账号信息
- **➕ 创建服务账号**: 为用户创建新的服务账号
- **✏️ 编辑服务账号**: 修改现有服务账号的配置
- **🗑️ 删除服务账号**: 安全删除不需要的服务账号
- **🔄 重新生成密钥**: 生成新的服务账号密钥

### 3. 服务账号信息展示
每个服务账号卡片显示：
- **显示名称**: 用户友好的服务账号名称
- **服务账号邮箱**: Google格式的邮箱地址
- **密钥文件名**: 对应的JSON密钥文件
- **服务类型**: Google、Azure、AWS等
- **创建时间**: 服务账号的创建时间
- **启用状态**: 当前服务账号的启用/禁用状态

### 4. 用户交互功能
- **确认对话框**: 删除操作前的安全确认
- **实时通知**: 操作成功/失败的即时反馈
- **加载动画**: 异步操作的加载指示
- **响应式设计**: 支持桌面和移动设备

## 🎨 界面设计特点

### 现代化UI
- **Tailwind CSS**: 使用原子化CSS框架
- **Font Awesome**: 图标系统
- **渐变动画**: 平滑的界面过渡效果
- **卡片布局**: 清晰的信息层级

### 用户体验
- **直观操作**: 符合用户习惯的交互方式
- **即时反馈**: 所有操作都有明确的状态反馈
- **错误处理**: 友好的错误信息提示
- **键盘支持**: 支持键盘导航

## 🔧 技术架构

### 前端技术栈
- **React 18**: 现代化的前端框架
- **Babel Standalone**: 浏览器端JSX编译
- **Tailwind CSS**: 实用优先的CSS框架
- **Axios**: HTTP客户端库

### 后端API集成
- **RESTful API**: 标准的REST接口设计
- **JSON格式**: 统一的数据交换格式
- **错误处理**: 完善的错误处理机制
- **无认证设计**: 便于内部管理使用

## 📱 访问方式

### 开发环境
```bash
# 启动Node.js服务
cd nodejs
npm start

# 访问管理界面
http://localhost:8889/admin/
```

### 生产环境
```
http://47.239.10.174:8889/admin/
```

## 🔄 API 端点

### 用户管理
- `GET /api/clients` - 获取用户列表
- `POST /api/clients` - 创建新用户
- `PUT /api/clients/:id` - 更新用户信息
- `DELETE /api/clients/:id` - 删除用户

### Service Account 管理
- `GET /api/server-accounts` - 获取服务账号列表
- `GET /api/server-accounts?client_token=xxx` - 获取指定用户的服务账号
- `POST /api/server-accounts` - 创建新服务账号
- `PUT /api/server-accounts/:id` - 更新服务账号
- `DELETE /api/server-accounts/:id` - 删除服务账号
- `POST /api/server-accounts/:id/regenerate-key` - 重新生成密钥

## 💾 数据持久化

### 配置文件
界面读取和管理以下配置文件：
- `../data/map/map-config.json` - 用户和服务账号配置

### 服务账号数据
- **配置文件存储**: 从JSON配置文件读取现有服务账号
- **内存存储**: 新创建的服务账号存储在内存中
- **模拟数据**: 当配置文件不可用时使用模拟数据

## 🎯 使用指南

### 1. 访问管理界面
在浏览器中打开管理界面URL

### 2. 选择用户
- 使用顶部下拉菜单选择要管理的用户
- 系统会自动加载该用户的所有服务账号

### 3. 查看服务账号
- 服务账号以卡片形式展示
- 每个卡片显示完整的账号信息
- 启用/禁用状态用不同颜色标识

### 4. 创建服务账号
- 点击"创建服务账号"按钮
- 填写服务账号信息：
  - 显示名称
  - 客户端Token
  - 服务账号邮箱
  - 密钥文件名
  - 服务类型
  - 启用状态
- 点击"创建"完成

### 5. 编辑服务账号
- 点击服务账号卡片上的"编辑"按钮
- 修改需要更新的字段
- 点击"更新"保存更改

### 6. 删除服务账号
- 点击服务账号卡片上的"删除"按钮
- 在确认对话框中确认删除操作
- 系统会安全删除该服务账号

### 7. 重新生成密钥
- 点击服务账号卡片上的"重新生成密钥"按钮
- 系统会为该服务账号生成新的私钥
- 旧密钥将自动失效

## 🔒 安全注意事项

### 访问控制
- 界面目前设计为内部管理使用
- 建议在生产环境中添加适当的访问控制
- 敏感操作（删除、密钥重新生成）都有确认对话框

### 数据安全
- 服务账号密钥在传输过程中使用HTTPS加密
- 建议定期更新服务账号密钥
- 删除操作不可恢复，请谨慎操作

## 🚨 故障排除

### 常见问题

1. **页面无法加载**
   - 检查Node.js服务是否正常运行
   - 确认端口8889是否可访问

2. **API请求失败**
   - 检查网络连接
   - 查看浏览器控制台的错误信息
   - 确认后端API服务状态

3. **用户列表为空**
   - 检查`data/map/map-config.json`文件是否存在
   - 确认配置文件格式正确

4. **服务账号不显示**
   - 确认用户配置中包含服务账号信息
   - 检查`key_filename_gemini`字段是否正确

### 调试方式
1. 打开浏览器开发者工具
2. 查看Console面板的错误信息
3. 检查Network面板的API请求状态
4. 查看Node.js服务日志

## 📈 未来改进计划

### 功能增强
- [ ] 添加用户认证和权限控制
- [ ] 支持批量操作
- [ ] 添加服务账号使用统计
- [ ] 支持密钥下载功能
- [ ] 添加操作日志记录

### 界面优化
- [ ] 添加暗色主题支持
- [ ] 改进移动端体验
- [ ] 添加更多可视化图表
- [ ] 支持多语言界面

### 性能优化
- [ ] 实现前端代码分割
- [ ] 添加数据缓存机制
- [ ] 优化API响应速度
- [ ] 减少不必要的重渲染

## 📞 技术支持

如有问题或建议，请：
1. 查看此README文档
2. 检查浏览器控制台错误信息
3. 联系开发团队获取支持

---

*最后更新: 2024年12月*